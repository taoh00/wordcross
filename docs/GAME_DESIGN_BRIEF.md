# 我爱填单词 - 游戏设计简报

> 版本: 2.0  
> 更新日期: 2026-01-24  
> 状态: 开发中

---

## 一、项目概述

「我爱填单词」是一款趣味英语学习填字游戏，结合纽约时报 Mini Crossword 的玩法，针对中国学生的英语学习场景设计。游戏通过填字游戏的形式，帮助用户在娱乐中记忆和巩固英语词汇。

### 核心特色
- **CSP密集布局算法**：智能生成高质量填字谜题，保证密度≥40%，交叉验证
- **多词库支持**：覆盖小学到考研、雅思托福等12个词库
- **多模式玩法**：闯关、无限、计时、PK四种游戏模式
- **社交竞技**：排行榜、PK对战等社交功能

---

## 二、词库体系

| 词库代码 | 名称 | 适用人群 | 词汇量级 |
|---------|------|---------|---------|
| primary | 小学 | 小学1-6年级 | 数百 |
| junior | 初中 | 初中7-9年级 | 数百-千 |
| senior | 高中 | 高中10-12年级 | 千级 |
| ket | KET | 剑桥英语入门 | 数百 |
| pet | PET | 剑桥英语初级 | 千级 |
| cet4 | CET-4 | 大学四级 | 千级 |
| cet6 | CET-6 | 大学六级 | 千级 |
| ielts | 雅思 | 出国留学 | 千级 |
| toefl | 托福 | 出国留学 | 千级 |
| gre | GRE | 研究生入学 | 千级 |
| postgrad | 考研 | 国内考研 | 千级 |
| common_words | 常用词汇 | 通用 | 千级 |

---

## 三、游戏模式设计

### 3.1 闯关模式 🏰

闯关模式是游戏的核心玩法，玩家按顺序通关，解锁更大的网格和更难的题目。

#### 3.1.1 网格规模与关卡数量

| 网格大小 | 关卡数量 | 累计关卡 | 说明 |
|---------|---------|---------|------|
| 4×4 | 9关 | 9 | 入门级 |
| 5×5 | 18关 | 27 | 基础级 |
| 6×6 | 18关 | 45 | 进阶级 |
| 7×7 | 18关 | 63 | 中级 |
| 8×8 | 18关/54关 | 81/117 | 小学54关，其他18关 |
| 9×9 | 18关 | 99/135 | 小学无此级别 |
| 10×10 | 81关 | 180/216 | 小学无此级别 |

#### 3.1.2 词库差异化

| 词库类型 | 最大网格 | 8×8关卡数 | 总关卡数 |
|---------|---------|----------|---------|
| 小学 (primary) | 8×8 | 54关 | **117关** |
| 其他词库 | 10×10 | 18关 | **180关** |

> 说明：小学词库没有9×9和10×10的关卡，8×8作为终极挑战有54关

#### 3.1.3 解锁机制
- 玩家必须通过当前关卡才能解锁下一关
- 每关根据完成时间和准确率给予1-3星评价
- 支持重玩已通关关卡以获取更高星级

---

### 3.2 无限模式 ♾️

无限模式提供无限量的随机关卡，玩家可自选难度进行练习。

#### 3.2.1 难度设置

| 难度 | 单词长度范围 | 网格大小范围 |
|-----|-------------|-------------|
| 低 | 2-4个字母 | 随机 |
| 中 | 3-6个字母 | 随机 |
| 高 | 5-10个字母 | 随机 |

#### 3.2.2 限时机制

每关有时间限制，根据网格大小递增：

| 网格大小 | 时间限制 | 说明 |
|---------|---------|------|
| 4×4 | 30秒 | 0:30 |
| 5×5 | 40秒 | 0:40 |
| 6×6 | 50秒 | 0:50 |
| 7×7 | 60秒 | 1:00 |
| 8×8 | 70秒 | 1:10 |
| 9×9 | 80秒 | 1:20 |
| 10×10 | 90秒 | 1:30 |

> 公式：限时 = 30 + (网格大小 - 4) × 10 秒

#### 3.2.3 玩法特点
- 矩阵大小随机选择
- 超时则游戏结束，记录当前分数
- 连续通关可获得连击加成

#### 3.2.4 排行榜机制

无限模式设有专属排行榜，按以下维度分组排名：

| 维度 | 分组方式 | 说明 |
|-----|---------|------|
| 词库 | 12个词库独立排名 | 如：CET-4、雅思各自独立 |
| 难度 | 低/中/高独立排名 | 同一词库下按难度分开 |

**排名规则**：
- 按**累计答对单词数**排序（历史最高记录）
- 记录玩家在每个组合（词库+难度）下的最大累计答对单词数
- 相同累计数按最后更新时间排序

**示例榜单**：
```
CET-4 · 中等难度 榜单
排名  玩家     累计答对
1     小明     1,247 个
2     小红     1,089 个
3     小刚       956 个
...
```

---

### 3.3 计时模式 ⏱️

计时模式考验玩家在固定时间内的答题效率和准确率。

#### 3.3.1 时长选项
- 3分钟
- 5分钟
- 10分钟

#### 3.3.2 玩法规则
- 矩阵大小随机生成
- 难度由玩家预先选择（低/中/高）
- 计算在同一时间内答对的单词数量
- 答完一套自动进入下一套

#### 3.3.3 排名机制
- 按同一词库、同一难度、同一时长分组排名
- 根据答对单词数量排序
- 相同数量按用时排序（用时少者优先）

---

### 3.4 PK模式 ⚔️

PK模式提供1v1实时对战功能，考验玩家的反应速度和词汇量。

#### 3.4.1 建立擂台
1. 发起方选择：
   - 词库（如：CET-4）
   - 时长（如：5分钟）
2. 生成擂台链接/二维码
3. 等待对手加入

#### 3.4.2 对战规则
- 开始后双方题目完全一致
- 互相看不到对方的答题过程
- 能够看到对方已答对的单词数量（实时更新）
- 一方答完当前套题后自动进入下一套
- 另一方答完后进入同一套题（保持同步）

#### 3.4.3 胜负判定
- 时间结束后，答对单词数量多的一方获胜
- 平局情况按用时判定

#### 3.4.4 排名与记录
- 系统记录每个玩家的获胜次数
- 按获胜次数进行排名
- 榜单分类：
  - **分组榜单**：每个词库单独排名
  - **总榜单**：所有词库综合排名

---

## 四、通用关卡玩法 🎮

### 4.1 游戏界面结构

```
┌─────────────────────────────────┐
│ [返回] 闯关 第1关   ⏱00:30   🌟50 │  ← 顶部信息栏
├─────────────────────────────────┤
│                                 │
│     ┌─┬─┬─┬─┬─┐               │
│     │C│A│T│ │ │               │  ← 填字网格
│     ├─┼─┼─┼─┼─┤               │
│     │ │P│ │ │ │               │
│     └─┴─┴─┴─┴─┘               │
│                                 │
├─────────────────────────────────┤
│ 📝 单词列表（可滚动）           │  ← 单词面板
│ ① 横 C__ → 3字母 [猫]          │
│ ② 竖 A__ ↓ 3字母 [高手]        │
├─────────────────────────────────┤
│  Q W E R T Y U I O P           │
│   A S D F G H J K L            │  ← 虚拟键盘
│     Z X C V B N M ⌫           │
└─────────────────────────────────┘
```

### 4.2 核心交互流程

1. **选择单词**：点击单词列表或网格格子，选中当前要填的单词
2. **输入字母**：使用虚拟键盘输入字母，自动移动到下一个空格
3. **预填提示**：每个单词预填2-3个字母（首字母+中间/末尾字母）
4. **自动验证**：填完一个单词后自动验证，正确则：
   - 格子变绿色锁定
   - 播放正确音效
   - **自动播放该单词发音**
   - 显示单词释义
5. **完成通关**：所有单词填对后弹出通关弹窗

### 4.3 预填字母算法

沿用现有脚本逻辑，每个单词预填2-3个字母作为提示：

| 单词长度 | 预填数量 | 预填位置示例 |
|---------|---------|-------------|
| 3-4字母 | 2个 | 首字母 + 末字母（C_T） |
| 5+字母 | 3个 | 首字母 + 中间 + 末字母（A_P_E） |

### 4.4 单词详情卡片

点击下方单词列表的任意单词，弹出该单词的详细卡片：

```
┌────────────────────────────────┐
│           APPLE               │
│          /ˈæpəl/              │
│                               │
│     🔊 美音    🔊 英音         │
│                               │
│  📖 释义：                     │
│     n. 苹果                   │
│                               │
│  📝 例句：                     │
│     I eat an apple every day. │
│                               │
│         [关闭]                 │
└────────────────────────────────┘
```

卡片功能：
- 显示单词拼写（大写）
- 显示音标
- 美音/英音发音按钮（使用本地音频文件）
- 中文释义
- 例句（如有）

---

## 五、UI/UX 设计规范 🎨

### 5.1 设计风格

| 属性 | 规范 |
|-----|------|
| 整体风格 | **萌系卡通 Q版** |
| 主题色调 | 仅白色主题（不提供深色模式） |
| 圆角 | 大圆角（12-24px） |
| 阴影 | 卡通立体阴影（box-shadow 底部加粗） |
| 字体 | 圆润可爱字体（Nunito 或类似） |
| 动画 | 弹性动画，活泼不过度 |

### 5.2 配色方案（白色主题）

| 元素 | 颜色 |
|-----|------|
| 背景 | 浅渐变（#f8fafc → #e2e8f0） |
| 卡片背景 | 白色半透明（rgba(255,255,255,0.98)） |
| 主强调色 | 紫色系（#8b5cf6 → #7c3aed） |
| 成功色 | 绿色系（#10b981 → #34d399） |
| 警告色 | 橙黄色（#f59e0b → #fbbf24） |
| 错误色 | 红色系（#ef4444） |
| 预填字母 | 黄色卡片底（#fde68a） |

### 5.3 卡通元素

- 格子带立体阴影效果
- 按钮按下有弹性反馈
- 完成单词时有小动画庆祝
- 可考虑添加可爱吉祥物形象（后续）

---

## 六、音效系统 🔊

### 6.1 音效列表

| 音效类型 | 触发时机 | 文件路径 |
|---------|---------|----------|
| 背景音乐 | 进入游戏页面 | `/audio/bgm/game.mp3` |
| 输入字母 | 每次按键输入 | `/audio/sfx/type.mp3` |
| 删除字母 | 按退格键 | `/audio/sfx/delete.mp3` |
| 正确音效 | 单词填对 | `/audio/sfx/correct.mp3` |
| 错误音效 | 单词填错（可选） | `/audio/sfx/wrong.mp3` |
| 通关音效 | 关卡完成 | `/audio/sfx/level_complete.mp3` |
| 按钮点击 | 界面按钮点击 | `/audio/sfx/click.mp3` |

### 6.2 单词发音

- **发音来源**：本地音频文件（已下载）
  - 美音：`/data/audio/us/{word}.mp3`
  - 英音：`/data/audio/uk/{word}.mp3`
- **自动发音**：单词填对后自动播放（可在设置中关闭）
- **手动发音**：点击单词列表的🔊按钮，或详情卡片中的发音按钮

### 6.3 音量控制

所有音效音量可独立控制，默认值：
- 背景音乐：30%
- 音效：70%
- 单词发音：100%

---

## 七、设置功能 ⚙️

### 7.1 设置项

| 设置项 | 类型 | 默认值 | 说明 |
|-------|------|--------|------|
| 自动发音 | 开关 | 开启 | 单词填对后自动播放发音 |
| 发音类型 | 单选 | 美音 | 美音(US) / 英音(UK) |
| 背景音乐 | 开关 | 开启 | 游戏背景音乐 |
| 音效 | 开关 | 开启 | 输入、正确等音效 |
| 震动反馈 | 开关 | 开启 | 移动端按键震动（如支持） |

### 7.2 设置存储

所有设置项存储在 localStorage：
```javascript
{
  "settings": {
    "autoSpeak": true,
    "voiceType": "us",  // "us" 或 "uk"
    "bgMusic": true,
    "soundEffect": true,
    "vibration": true
  }
}
```

---

## 八、用户系统（测试版） 👤

### 8.1 快速注册弹窗

测试版本进入时显示快速注册弹窗：

```
┌────────────────────────────────┐
│        🎮 欢迎来到             │
│       我爱填单词！             │
│                               │
│   请输入你的昵称：             │
│   ┌──────────────────────┐    │
│   │  小明同学             │    │
│   └──────────────────────┘    │
│                               │
│   可选头像：                   │
│   😊 😎 🤓 😺 🐶 🦊           │
│                               │
│        [开始游戏]              │
└────────────────────────────────┘
```

### 8.2 用户数据存储

用户信息缓存到 localStorage + Cookie：
```javascript
{
  "user": {
    "id": "uuid-xxx",
    "nickname": "小明同学",
    "avatar": "😊",
    "createdAt": "2026-01-24T10:00:00Z"
  }
}
```

### 8.3 自动登录

- 下次访问自动读取本地用户信息
- 如存在则跳过注册弹窗直接进入
- 排行榜使用此用户信息显示

---

## 九、排行榜系统 🏆

### 9.1 榜单类型

| 榜单 | 说明 | 排序依据 |
|-----|------|---------|
| 闯关榜 | 各词库通关进度排名 | 通关关卡数 > 总星数 |
| 无限榜 | 无限模式累计答对排名 | 累计答对单词数 |
| 计时榜 | 计时模式分数排名 | 答对单词数 > 用时 |
| PK榜 | PK模式战绩排名 | 获胜次数 |
| 总榜 | 综合排名 | 综合积分 |

### 9.2 榜单维度
- 按词库分组（12个词库各有独立榜单）
- 按难度分组（低/中/高）
- 按时间周期（日榜/周榜/月榜/总榜）

---

## 十、技术实现（已完成）

### 10.1 填字生成器

采用 **CSP（约束满足问题）密集布局算法**：

- **核心文件**：`src/backend/configurable_puzzle_generator.py`
- **密度要求**：≥40%
- **交叉验证**：确保横向纵向形成的字母序列都是有效单词
- **参数化配置**：
  - 难度：低(2-4字母) / 中(3-6字母) / 高(5-10字母)
  - 题量：少(4x4,5x5) / 中(6x6,7x7,8x8) / 多(9x9,10x10)

### 10.2 前后端架构

```
┌─────────────────────────────────────────┐
│                 前端                     │
│  Vue 3 + Vite + Tailwind CSS           │
│  端口：10010                            │
├─────────────────────────────────────────┤
│                 后端                     │
│  Python FastAPI                         │
│  端口：10012                            │
├─────────────────────────────────────────┤
│               数据层                     │
│  词库JSON + 关卡JSON                    │
└─────────────────────────────────────────┘
```

### 10.3 已实现功能

| 功能 | 状态 | 说明 |
|-----|------|------|
| 首页UI | ✅ 完成 | 卡通风格，模式/词库选择 |
| 闯关模式 | ✅ 基础完成 | 10关，待扩展到完整关卡体系 |
| 无限模式 | ✅ 基础完成 | 随机关卡生成 |
| 计时模式 | ✅ 基础完成 | 3/5/10分钟时长 |
| PK模式 | 🔲 待开发 | UI已有，功能待实现 |
| 测试模式 | ✅ 完成 | 验证关卡答案 |
| 排行榜 | 🔲 待开发 | UI已有，功能待实现 |
| CSP生成器 | ✅ 完成 | 可配置参数生成 |
| 词库管理 | ✅ 完成 | 12个词库 |

---

## 十一、待完成事项清单 📋

### 高优先级（本次迭代）

| # | 任务 | 状态 | 说明 |
|---|-----|------|------|
| 1 | 单词详情卡片弹窗 | ✅ 已完成 | 点击单词列表弹出详细信息卡片 |
| 2 | 本地音频发音集成 | ✅ 已完成 | 使用 `/data/audio/` 下的mp3文件播放发音 |
| 3 | 美音/英音切换 | ✅ 已完成 | 设置中可选发音类型 |
| 4 | 设置页面开发 | ✅ 已完成 | 自动发音、背景音乐、音效等开关 |
| 5 | 游戏音效系统 | ✅ 已完成 | 背景音乐、输入音效、成功音效等 |
| 6 | 快速注册弹窗 | ✅ 已完成 | 首次进入输入昵称，存储到cookie |
| 7 | UI风格统一优化 | ✅ 已完成 | 更萌、更卡通、更Q版，仅白色主题 |

### 中优先级

| # | 任务 | 状态 | 说明 |
|---|-----|------|------|
| 8 | 闯关模式关卡扩展 | 🔲 待开发 | 从10关扩展到完整关卡体系（4x4到10x10） |
| 9 | 无限模式限时机制 | 🔲 待开发 | 根据网格大小设置时限 |
| 10 | 通关动画优化 | 🔲 待开发 | 更丰富的通关庆祝动画 |
| 11 | 计时模式排名逻辑 | 🔲 待开发 | 本地排名存储和展示 |

### 低优先级

| # | 任务 | 状态 | 说明 |
|---|-----|------|------|
| 12 | 排行榜后端API | 🔲 待开发 | 服务端存储和查询 |
| 13 | PK模式 WebSocket | 🔲 待开发 | 实时对战功能 |
| 14 | 吉祥物设计 | 🔲 待开发 | 可爱的游戏吉祥物形象 |

---

## 十二、开发优先级（原计划）

### 第一阶段（核心完善）
1. [x] 基础游戏界面
2. [x] 预填字母机制
3. [x] 单词验证和自动发音
4. [x] 单词详情卡片
5. [x] 设置功能
6. [x] 音效系统
7. [x] 快速注册

### 第二阶段（内容扩展）
8. [ ] 闯关模式关卡体系完整实现（4x4到10x10）
9. [ ] 无限模式限时机制
10. [ ] 计时模式排名逻辑

### 第三阶段（社交功能）
11. [ ] 排行榜后端API
12. [ ] 用户系统（完整登录/注册）
13. [ ] 数据持久化

### 第四阶段（对战功能）
14. [ ] PK模式 WebSocket 实时通信
15. [ ] 擂台系统
16. [ ] 战绩记录

---

## 十三、附录

### 13.1 关卡时间公式

```
时间限制(秒) = 30 + (网格大小 - 4) × 10
```

### 13.2 网格密度计算

```
密度 = 填字格子数 / 总格子数
要求：密度 ≥ 40%
```

### 13.3 音频文件路径

```
# 单词发音（已下载）
美音: /data/audio/us/{word}.mp3
英音: /data/audio/uk/{word}.mp3

# 游戏音效（待添加）
背景音乐: /public/audio/bgm/game.mp3
输入音效: /public/audio/sfx/type.mp3
正确音效: /public/audio/sfx/correct.mp3
通关音效: /public/audio/sfx/level_complete.mp3
```

### 13.4 API端点（已实现）

| 端点 | 方法 | 说明 |
|-----|------|------|
| `/api/test-mode/config` | GET | 获取配置选项 |
| `/api/test-mode/levels` | GET | 获取关卡列表 |
| `/api/test-mode/refresh` | POST | 刷新指定组合 |
| `/api/test-mode/refresh-all` | POST | 刷新所有组合 |

### 13.5 本地存储结构

```javascript
// 用户信息
localStorage.user = {
  id: "uuid-xxx",
  nickname: "小明同学",
  avatar: "😊",
  createdAt: "2026-01-24T10:00:00Z"
}

// 设置
localStorage.settings = {
  autoSpeak: true,
  voiceType: "us",  // "us" | "uk"
  bgMusic: true,
  soundEffect: true,
  vibration: true
}

// 进度
localStorage.campaign_progress_{group} = {
  unlocked: 5,
  completed: {
    1: { stars: 3, score: 150, time: 45 },
    2: { stars: 2, score: 120, time: 60 },
    ...
  }
}
```

---

*文档结束*
