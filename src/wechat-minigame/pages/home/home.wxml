<!--pages/home/home.wxml-->
<view class="home-screen">
  <!-- æ ‡é¢˜åŒº -->
  <view class="header-section">
    <view class="logo-area">
      <text class="stars-left animate-bounce">ğŸŒŸ</text>
      <text class="title">æˆ‘çˆ±å¡«å•è¯</text>
      <text class="stars-right animate-bounce" style="animation-delay: 1s;">ğŸŒŸ</text>
    </view>
    <text class="subtitle">WordCross Â· è¶£å‘³è‹±è¯­å­¦ä¹ </text>
    
    <!-- ç”¨æˆ·ä¿¡æ¯æ  -->
    <view class="user-info-bar">
      <text class="user-avatar">{{ userAvatar }}</text>
      <text class="user-name">{{ userName }}</text>
      <view class="user-stats">
        <text class="stat-item" data-tip="ä½“åŠ›">âš¡{{ energy }}</text>
        <text class="stat-item" data-tip="æç¤º">ğŸ’¡{{ hintCount }}</text>
        <text class="stat-item" data-tip="å‘éŸ³">ğŸ”Š{{ speakCount }}</text>
      </view>
    </view>
  </view>

  <!-- ä¸»å¡ç‰‡ -->
  <view class="main-card card">
    <!-- æ¨¡å¼é€‰æ‹© -->
    <view wx:if="{{ currentStep === 'mode' }}" class="mode-selection">
      <text class="section-title">ğŸ® é€‰æ‹©æ¸¸æˆæ¨¡å¼</text>
      <view class="mode-grid">
        <!-- é—¯å…³æ¨¡å¼ -->
        <view class="mode-btn campaign" bindtap="selectMode" data-mode="campaign">
          <text class="mode-icon">ğŸ°</text>
          <view class="mode-info">
            <text class="mode-name">é—¯å…³æ¨¡å¼</text>
            <text class="mode-desc">è¯åº“é—¯å…³</text>
          </view>
        </view>

        <!-- æ— é™æ¨¡å¼ -->
        <view class="mode-btn endless" bindtap="selectMode" data-mode="endless">
          <text class="mode-icon">â™¾ï¸</text>
          <view class="mode-info">
            <text class="mode-name">æ— é™æ¨¡å¼</text>
            <text class="mode-desc">éšæœºå…³å¡</text>
          </view>
        </view>

        <!-- è®¡æ—¶æ¨¡å¼ -->
        <view class="mode-btn timed" bindtap="selectMode" data-mode="timed">
          <text class="mode-icon">â±ï¸</text>
          <view class="mode-info">
            <text class="mode-name">è®¡æ—¶æ¨¡å¼</text>
            <text class="mode-desc">é™æ—¶æŒ‘æˆ˜</text>
          </view>
        </view>

        <!-- PKæ¨¡å¼ -->
        <view class="mode-btn pk" bindtap="selectMode" data-mode="pk">
          <text class="mode-icon">âš”ï¸</text>
          <view class="mode-info">
            <text class="mode-name">PKæ¨¡å¼</text>
            <text class="mode-desc">åœ¨çº¿å¯¹æˆ˜</text>
          </view>
        </view>
      </view>
      
      <!-- å¿«æ·å…¥å£ -->
      <view class="quick-links">
        <!-- æ’è¡Œæ¦œ -->
        <view class="link-card leaderboard" bindtap="goToLeaderboard">
          <text class="link-icon">ğŸ†</text>
          <text class="link-text">æ’è¡Œæ¦œ</text>
          <text class="link-arrow">â€º</text>
        </view>
        
        <!-- è®¾ç½® -->
        <view class="link-card settings" bindtap="goToSettings">
          <text class="link-icon">âš™ï¸</text>
          <text class="link-text">è®¾ç½®</text>
          <text class="link-arrow">â€º</text>
        </view>
      </view>
    </view>

    <!-- æ—¶é—´é€‰æ‹©ï¼ˆè®¡æ—¶/PKæ¨¡å¼ï¼‰ -->
    <view wx:elif="{{ currentStep === 'duration' }}" class="duration-selection">
      <view class="selection-header">
        <view class="back-btn" bindtap="goBack">â† è¿”å›</view>
        <text class="section-title">â±ï¸ é€‰æ‹©æ—¶é—´</text>
      </view>

      <view class="duration-grid">
        <view 
          wx:for="{{ durationOptions }}" 
          wx:key="value"
          class="duration-btn {{ selectedDuration === item.value ? 'active' : '' }}"
          bindtap="selectDuration"
          data-value="{{ item.value }}"
        >
          <text class="duration-icon">{{ item.icon }}</text>
          <text class="duration-label">{{ item.label }}</text>
        </view>
      </view>

      <view class="hint-box">
        <text class="hint-icon">ğŸ’¡</text>
        <text class="hint-text">é€‰æ‹©æ¸¸æˆæ€»æ—¶é•¿</text>
      </view>
    </view>

    <!-- éš¾åº¦é€‰æ‹©ï¼ˆæ— é™/è®¡æ—¶/PKæ¨¡å¼ï¼‰ -->
    <view wx:elif="{{ currentStep === 'difficulty' }}" class="difficulty-selection">
      <view class="selection-header">
        <view class="back-btn" bindtap="goBack">â† è¿”å›</view>
        <text class="section-title">âš¡ é€‰æ‹©éš¾åº¦</text>
      </view>

      <!-- å·²é€‰æ—¶é—´ -->
      <view wx:if="{{ selectedMode === 'timed' || selectedMode === 'pk' }}" class="selected-banner duration-banner">
        <text class="banner-label">å·²é€‰æ—¶é—´ï¼š</text>
        <text class="banner-value">{{ selectedDurationLabel }}</text>
      </view>

      <view class="difficulty-grid">
        <view 
          wx:for="{{ difficultyOptions }}" 
          wx:key="code"
          class="difficulty-btn {{ item.code }}"
          bindtap="selectDifficulty"
          data-code="{{ item.code }}"
        >
          <text class="diff-icon">{{ item.icon }}</text>
          <view class="diff-info">
            <text class="diff-name">{{ item.name }}</text>
            <text class="diff-desc">{{ item.desc }}</text>
          </view>
        </view>
      </view>

      <view class="hint-box">
        <text class="hint-icon">ğŸ’¡</text>
        <text class="hint-text">éš¾åº¦å†³å®šå•è¯é•¿åº¦èŒƒå›´</text>
      </view>
    </view>

    <!-- è¯åº“é€‰æ‹© -->
    <view wx:elif="{{ currentStep === 'group' }}" class="group-selection">
      <view class="selection-header">
        <view class="back-btn" bindtap="goBack">â† è¿”å›</view>
        <text class="section-title">ğŸ“š é€‰æ‹©è¯åº“</text>
      </view>

      <!-- å·²é€‰éš¾åº¦ -->
      <view wx:if="{{ needsDifficultyFirst }}" class="selected-banner difficulty-banner">
        <text class="banner-label">å·²é€‰éš¾åº¦ï¼š</text>
        <text class="banner-value {{ selectedDifficulty }}">{{ selectedDifficultyName }}</text>
      </view>

      <scroll-view class="group-scroll" scroll-y>
        <view class="group-grid">
          <view 
            wx:for="{{ vocabGroups }}" 
            wx:key="code"
            class="group-btn"
            bindtap="selectGroup"
            data-group="{{ item }}"
          >
            <text class="group-icon">{{ item.icon }}</text>
            <text class="group-name">{{ item.name }}</text>
            <text wx:if="{{ item.hasSubGroups }}" class="group-arrow">â€º</text>
          </view>
        </view>
      </scroll-view>
    </view>

    <!-- ç»†åˆ†ç±»é€‰æ‹© -->
    <view wx:elif="{{ currentStep === 'subgroup' }}" class="group-selection">
      <view class="selection-header">
        <view class="back-btn" bindtap="goBack">â† è¿”å›</view>
        <text class="section-title">ğŸ“‚ é€‰æ‹©{{ selectedGroupData.name }}ç»†åˆ†</text>
      </view>

      <scroll-view class="group-scroll" scroll-y>
        <view class="group-grid subgroup-grid">
          <view 
            wx:for="{{ selectedGroupData.subGroups }}" 
            wx:key="code"
            class="group-btn {{ item.code.endsWith('_all') ? 'all-btn' : '' }}"
            bindtap="selectSubGroup"
            data-code="{{ item.code }}"
          >
            <text class="group-icon">{{ item.icon }}</text>
            <text class="group-name">{{ item.name }}</text>
          </view>
        </view>
      </scroll-view>
    </view>

    <!-- å…³å¡é€‰æ‹©ï¼ˆé—¯å…³æ¨¡å¼ï¼‰ -->
    <view wx:elif="{{ currentStep === 'level' }}" class="level-selection">
      <view class="selection-header">
        <view class="back-btn" bindtap="goBack">â† è¿”å›</view>
        <text class="section-title">ğŸ° é€‰æ‹©å…³å¡</text>
      </view>

      <view class="level-info-banner">
        <text class="banner-icon">ğŸ“š</text>
        <text class="banner-text">{{ currentGroupName }}</text>
        <text class="banner-progress">{{ completedLevels }}/{{ maxLevels }}å…³</text>
      </view>

      <!-- å…³å¡ä¸»åŒºåŸŸ -->
      <view class="level-main-area">
        <view class="page-nav-btn prev {{ currentPage <= 1 ? 'disabled' : '' }}" bindtap="prevPage">â€¹</view>
        
        <scroll-view class="level-scroll" scroll-y>
          <view class="level-grid">
            <view 
              wx:for="{{ currentPageLevels }}" 
              wx:key="*this"
              class="level-btn {{ getLevelClass(item) }}"
              bindtap="startLevel"
              data-level="{{ item }}"
            >
              <text class="level-number">{{ item }}</text>
              <text class="level-stars">{{ getLevelStars(item) }}</text>
              <text class="level-status">{{ getLevelStatus(item) }}</text>
            </view>
          </view>
        </scroll-view>
        
        <view class="page-nav-btn next {{ currentPage >= totalPages ? 'disabled' : '' }}" bindtap="nextPage">â€º</view>
      </view>

      <!-- åˆ†é¡µå™¨ -->
      <view class="range-pagination">
        <text class="range-label">{{ rangeLabel }}</text>
        <view class="range-buttons">
          <view 
            wx:for="{{ visibleRanges }}" 
            wx:key="*this"
            class="range-btn {{ currentPage === item ? 'active' : '' }}"
            bindtap="goToPage"
            data-page="{{ item }}"
          >{{ getRangeText(item) }}</view>
        </view>
      </view>
    </view>
  </view>

  <!-- åº•éƒ¨è£…é¥° -->
  <view class="footer-decoration">
    <text class="footer-icon animate-float">ğŸ¨</text>
    <text class="footer-icon animate-float" style="animation-delay: 1s;">ğŸ“–</text>
    <text class="footer-icon animate-float" style="animation-delay: 2s;">âœï¸</text>
  </view>
</view>
