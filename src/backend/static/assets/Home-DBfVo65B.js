import{_ as Ce,u as Se,o as we,a as i,c as r,b as s,d as $e,t as c,e as j,w as R,F as P,r as x,n as y,f as k,g as Ge,h as v,i as p,j as Le,k as Ne}from"./index-DYfv8LOO.js";import{u as Pe}from"./game-BMruQe6J.js";const xe={class:"home-screen"},Oe={class:"header-section"},Ie={class:"user-info-bar"},Me={class:"user-avatar"},De={class:"user-name"},Je={class:"user-stats"},Te={class:"stat-item",title:"ä½“åŠ›"},Ue={class:"stat-item",title:"æç¤ºé“å…·"},Ee={class:"stat-item",title:"ç¿»è¯‘é“å…·"},je={class:"main-card"},Re={key:0,class:"mode-selection"},Fe={class:"mode-grid"},Be={class:"test-reset-row"},He={key:1,class:"difficulty-selection"},Ve={class:"difficulty-grid"},Ae=["onClick"],We={class:"diff-icon"},ze={class:"diff-info"},Ke={class:"diff-name"},qe={class:"diff-desc"},Qe={key:2,class:"group-selection"},Xe={key:0,class:"selected-difficulty-banner"},Ye={class:"group-grid"},Ze=["onClick"],es={class:"group-icon"},ss={class:"group-name"},ts={key:0,class:"group-arrow"},as={key:3,class:"group-selection"},ns={class:"selection-header"},os={class:"section-title"},ls={class:"group-grid subgroup-grid"},cs=["onClick"],us={class:"group-icon"},is={class:"group-name"},rs={key:4,class:"level-selection"},ds={class:"level-info-banner"},vs={class:"banner-text"},ps={class:"banner-progress"},fs={class:"level-main-area"},ms=["disabled"],gs={class:"level-scroll-container"},_s={class:"level-grid"},bs=["onClick"],hs={class:"level-number"},ys={class:"level-stars"},ks={class:"level-status"},Cs=["disabled"],Ss={class:"range-pagination"},ws={class:"range-label"},$s={class:"range-buttons"},Gs={key:1,class:"range-ellipsis"},Ls=["onClick"],Ns={key:2,class:"range-ellipsis"},C=100,Ps={__name:"Home",setup(xs){const F=Ne(),_=Pe(),B=Se(),X=p(()=>B.avatar||"ğŸ˜Š"),Y=p(()=>B.nickname||"æ¸¸å®¢"),w=v(100),O=v(20),I=v(20);async function Z(){const t=Date.now();try{const e=localStorage.getItem("user_energy");if(e){const n=JSON.parse(e);let o=n.value??100;const S=n.lastUpdate||t,J=t-S,a=Math.floor(J/(1e3*60*60));if(a>=1){const h=Math.min(a,10),ye=h*10,E=Math.min(o+ye,100);if(E>o){console.log(`ç¦»çº¿${a}å°æ—¶ï¼Œæœ‰æ•ˆ${h}å°æ—¶ï¼Œæ¢å¤${E-o}ç‚¹ä½“åŠ›`),o=E,localStorage.setItem("user_energy",JSON.stringify({value:o,lastUpdate:t}));try{await fetch("/api/user/energy",{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({energy:o})})}catch(ke){console.error("åŒæ­¥æ¢å¤çš„ä½“åŠ›åˆ°æœåŠ¡å™¨å¤±è´¥:",ke)}}}w.value=o}else w.value=100,localStorage.setItem("user_energy",JSON.stringify({value:100,lastUpdate:t}))}catch{w.value=100}try{const e=JSON.parse(localStorage.getItem("user_energy")||"{}");e.lastUpdate=t,localStorage.setItem("user_energy",JSON.stringify(e))}catch{}try{const e=localStorage.getItem("game_props");if(e){const n=JSON.parse(e);O.value=n.hintLetterCount??20,I.value=n.showTranslationCount??20}}catch{O.value=20,I.value=20}}const u=v("mode"),f=v(null),d=v(null),g=v(null),T=v(null),$=v("medium"),b=v({}),H=[{code:"low",name:"ç®€å•",desc:"2-4å­—æ¯çŸ­è¯",icon:"ğŸŒ±"},{code:"medium",name:"ä¸­ç­‰",desc:"3-6å­—æ¯è¯æ±‡",icon:"ğŸŒ¿"},{code:"high",name:"å›°éš¾",desc:"5-10å­—æ¯é•¿è¯",icon:"ğŸŒ²"}],V=p(()=>f.value==="endless"||f.value==="timed"||f.value==="pk"),l=v(1),G=v({}),U=p(()=>f.value==="campaign"||f.value==="endless"),L=p(()=>{const t=d.value;return t&&G.value[t]||0}),m=p(()=>Math.ceil(L.value/C)),ee=p(()=>{const t=(l.value-1)*C+1,e=Math.min(l.value*C,L.value),n=[];for(let o=t;o<=e;o++)n.push(o);return n});function se(){l.value>1&&l.value--}function te(){l.value<m.value&&l.value++}function A(t){const e=(t-1)*C+1,n=Math.min(t*C,L.value);return`${e}-${n}`}const ae=p(()=>{const t=(l.value-1)*C+1,e=Math.min(l.value*C,L.value);return`å½“å‰: ${t}-${e}`}),W=p(()=>m.value>1&&l.value>2),z=p(()=>m.value>1&&l.value<m.value-1),ne=p(()=>l.value>3),oe=p(()=>l.value<m.value-2),le=p(()=>{const t=[],e=Math.max(1,l.value-1),n=Math.min(m.value,l.value+1);for(let o=e;o<=n;o++)W.value&&o===1||z.value&&o===m.value||t.push(o);return t}),ce=p(()=>{const t=d.value,e=b.value[t]||{completed:{}};return`${Object.keys(e.completed).length}/${L.value}å…³`});we(async()=>{ue(),await Z(),ge(),_e()});function ue(){const t=e=>{const n=`campaign_progress_${e}`,o=localStorage.getItem(n);o?b.value[e]=JSON.parse(o):b.value[e]={unlocked:1,completed:{}}};_.groups.forEach(e=>{t(e.code),e.subGroups&&e.subGroups.forEach(n=>t(n.code))})}function ie(t){let e=_.groups.find(n=>n.code===t);if(e)return`${e.icon} ${e.name}`;for(const n of _.groups)if(n.subGroups){const o=n.subGroups.find(S=>S.code===t);if(o)return`${o.icon} ${o.name}`}return t}function re(t){if(!d.value)return"";const e=b.value[d.value]||{unlocked:1,completed:{}};return e.completed[t]?"completed":t<=e.unlocked||N.value?"current":"locked"}function de(t){if(!d.value)return"";const e=b.value[d.value]||{completed:{}};if(e.completed[t]){const n=e.completed[t].stars||3;return"â­".repeat(n)}return""}function ve(t){if(!d.value)return"";const e=b.value[d.value]||{unlocked:1,completed:{}};return e.completed[t]?"å·²é€šå…³":t<=e.unlocked||N.value?"æŒ‘æˆ˜":"ğŸ”’"}function M(t){f.value=t,t==="endless"||t==="timed"||t==="pk"?u.value="difficulty":u.value="group"}function pe(t){$.value=t,u.value="group"}async function fe(t){g.value=t,t.hasSubGroups&&U.value?u.value="subgroup":(d.value=t.code,_.currentGroup=t.code,f.value==="campaign"?(await Q(t.code),u.value="level"):K())}async function me(t){T.value=t,d.value=t,_.currentGroup=t,f.value==="campaign"?(await Q(t),u.value="level"):K()}function K(){f.value!=="campaign"&&localStorage.setItem("game_difficulty",$.value),f.value==="timed"&&localStorage.setItem("timed_duration","180"),F.push(`/game/${f.value}`)}const N=v(!1),q=v(!1);function ge(){try{const t=localStorage.getItem("game_debug_mode");N.value=t==="true"}catch{N.value=!1}}async function _e(){try{const t=await fetch("/data/levels_summary.json");if(!t.ok)throw new Error(`HTTP ${t.status}`);const e=await t.json();if(e&&e.groups){for(const n of e.groups)G.value[n.group_code]=n.level_count||0;console.log("å…³å¡æ•°é‡åŠ è½½å®Œæˆ:",G.value)}else console.warn("levels-summary æ•°æ®æ ¼å¼å¼‚å¸¸:",e)}catch(t){console.warn("åŠ è½½å…³å¡æ•°é‡å¤±è´¥:",t)}}async function Q(t){if(t){q.value=!0;try{const e=G.value[t];if(e)console.log(`è¯åº“ ${t} å…³å¡æ•°ï¼ˆå·²ç¼“å­˜ï¼‰ï¼š${e}`);else{const n=await _.getGroupLevelCount(t);n>0&&(G.value[t]=n),console.log(`è¯åº“ ${t} å…³å¡æ•°ï¼š${n}`)}}catch(e){console.warn(`è·å–è¯åº“ ${t} å…³å¡æ•°å¤±è´¥:`,e)}finally{q.value=!1}}}function be(t){const e=d.value,n=b.value[e]||{unlocked:1};!N.value&&t>n.unlocked||(localStorage.setItem(`campaign_level_${e}`,t.toString()),F.push("/game/campaign"))}async function he(){localStorage.setItem("user_energy",JSON.stringify({value:100,lastUpdate:Date.now()})),w.value=100,localStorage.setItem("game_props",JSON.stringify({hintLetterCount:20,showTranslationCount:20})),O.value=20,I.value=20;try{await fetch("/api/user/energy",{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({energy:100})}),await fetch("/api/user/props",{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({hintLetterCount:20,showTranslationCount:20})}),console.log("é‡ç½®æ•°æ®å·²åŒæ­¥åˆ°æœåŠ¡å™¨")}catch(t){console.error("åŒæ­¥é‡ç½®æ•°æ®åˆ°æœåŠ¡å™¨å¤±è´¥:",t)}alert("âœ… å·²é‡ç½®ï¼šèƒ½é‡100ç‚¹ï¼Œé“å…·å„20ä¸ª")}function D(){var t;u.value==="level"?(t=g.value)!=null&&t.hasSubGroups&&U.value?(u.value="subgroup",d.value=null,T.value=null):(u.value="group",d.value=null,g.value=null):u.value==="subgroup"?(u.value="group",g.value=null,T.value=null):u.value==="group"?V.value?(u.value="difficulty",g.value=null):(u.value="mode",f.value=null,g.value=null):u.value==="difficulty"&&(u.value="mode",f.value=null,$.value="medium")}return(t,e)=>{var o,S,J;const n=Le("router-link");return i(),r("div",xe,[s("div",Oe,[e[6]||(e[6]=$e('<div class="logo-area" data-v-5e5bf2d2><div class="stars-left" data-v-5e5bf2d2>ğŸŒŸ</div><h1 class="title" data-v-5e5bf2d2>æˆ‘çˆ±å¡«å•è¯</h1><div class="stars-right" data-v-5e5bf2d2>ğŸŒŸ</div></div><p class="subtitle" data-v-5e5bf2d2>WordCross Â· è¶£å‘³è‹±è¯­å­¦ä¹ </p>',2)),s("div",Ie,[s("div",Me,c(X.value),1),s("div",De,c(Y.value),1),s("div",Je,[s("span",Te,"âš¡"+c(w.value),1),s("span",Ue,"ğŸ’¡"+c(O.value),1),s("span",Ee,"ğŸ“–"+c(I.value),1)])])]),s("div",je,[u.value==="mode"?(i(),r("div",Re,[e[15]||(e[15]=s("h2",{class:"section-title"},"ğŸ® é€‰æ‹©æ¸¸æˆæ¨¡å¼",-1)),s("div",Fe,[s("button",{onClick:e[0]||(e[0]=a=>M("campaign")),class:"mode-btn campaign"},[...e[7]||(e[7]=[s("span",{class:"mode-icon"},"ğŸ°",-1),s("div",{class:"mode-info"},[s("div",{class:"mode-name"},"é—¯å…³æ¨¡å¼"),s("div",{class:"mode-desc"},"è¯åº“é—¯å…³")],-1)])]),s("button",{onClick:e[1]||(e[1]=a=>M("endless")),class:"mode-btn endless"},[...e[8]||(e[8]=[s("span",{class:"mode-icon"},"â™¾ï¸",-1),s("div",{class:"mode-info"},[s("div",{class:"mode-name"},"æ— é™æ¨¡å¼"),s("div",{class:"mode-desc"},"éšæœºå…³å¡")],-1)])]),s("button",{onClick:e[2]||(e[2]=a=>M("timed")),class:"mode-btn timed"},[...e[9]||(e[9]=[s("span",{class:"mode-icon"},"â±ï¸",-1),s("div",{class:"mode-info"},[s("div",{class:"mode-name"},"è®¡æ—¶æ¨¡å¼"),s("div",{class:"mode-desc"},"é™æ—¶æŒ‘æˆ˜")],-1)])]),s("button",{onClick:e[3]||(e[3]=a=>M("pk")),class:"mode-btn pk"},[...e[10]||(e[10]=[s("span",{class:"mode-icon"},"âš”ï¸",-1),s("div",{class:"mode-info"},[s("div",{class:"mode-name"},"PKæ¨¡å¼"),s("div",{class:"mode-desc"},"åœ¨çº¿å¯¹æˆ˜")],-1)])])]),s("div",Be,[j(n,{to:"/test-mode",class:"test-mode-card"},{default:R(()=>[...e[11]||(e[11]=[s("span",{class:"test-mode-icon"},"ğŸ§ª",-1),s("span",{class:"test-mode-text"},"æµ‹è¯•æ¨¡å¼",-1),s("span",{class:"test-mode-arrow"},"â€º",-1)])]),_:1}),s("button",{onClick:he,class:"reset-all-btn"},[...e[12]||(e[12]=[s("span",{class:"reset-icon"},"ğŸ”„",-1),s("span",{class:"reset-text"},"é‡ç½®å…¨éƒ¨",-1)])])]),j(n,{to:"/leaderboard",class:"leaderboard-card"},{default:R(()=>[...e[13]||(e[13]=[s("span",{class:"leaderboard-icon"},"ğŸ†",-1),s("span",{class:"leaderboard-text"},"æ’è¡Œæ¦œ",-1),s("span",{class:"leaderboard-arrow"},"â€º",-1)])]),_:1}),j(n,{to:"/settings",class:"settings-card"},{default:R(()=>[...e[14]||(e[14]=[s("span",{class:"settings-icon"},"âš™ï¸",-1),s("span",{class:"settings-text"},"è®¾ç½®",-1),s("span",{class:"settings-arrow"},"â€º",-1)])]),_:1})])):u.value==="difficulty"?(i(),r("div",He,[s("div",{class:"selection-header"},[s("button",{onClick:D,class:"back-btn"},"â† è¿”å›"),e[16]||(e[16]=s("h2",{class:"section-title"},"âš¡ é€‰æ‹©éš¾åº¦",-1))]),s("div",Ve,[(i(),r(P,null,x(H,a=>s("button",{key:a.code,onClick:h=>pe(a.code),class:y(["difficulty-btn",a.code])},[s("span",We,c(a.icon),1),s("div",ze,[s("div",Ke,c(a.name),1),s("div",qe,c(a.desc),1)])],10,Ae)),64))]),e[17]||(e[17]=s("div",{class:"difficulty-hint"},[s("span",{class:"hint-icon"},"ğŸ’¡"),s("span",{class:"hint-text"},"éš¾åº¦å†³å®šå•è¯é•¿åº¦èŒƒå›´")],-1))])):u.value==="group"?(i(),r("div",Qe,[s("div",{class:"selection-header"},[s("button",{onClick:D,class:"back-btn"},"â† è¿”å›"),e[18]||(e[18]=s("h2",{class:"section-title"},"ğŸ“š é€‰æ‹©è¯åº“",-1))]),V.value?(i(),r("div",Xe,[e[19]||(e[19]=s("span",{class:"banner-label"},"å·²é€‰éš¾åº¦ï¼š",-1)),s("span",{class:y(["banner-value",$.value])},c((o=H.find(a=>a.code===$.value))==null?void 0:o.name),3)])):k("",!0),s("div",Ye,[(i(!0),r(P,null,x(Ge(_).groups,a=>(i(),r("button",{key:a.code,onClick:h=>fe(a),class:"group-btn"},[s("span",es,c(a.icon),1),s("span",ss,c(a.name),1),a.hasSubGroups&&U.value?(i(),r("span",ts,"â€º")):k("",!0)],8,Ze))),128))])])):u.value==="subgroup"?(i(),r("div",as,[s("div",ns,[s("button",{onClick:D,class:"back-btn"},"â† è¿”å›"),s("h2",os,"ğŸ“‚ é€‰æ‹©"+c((S=g.value)==null?void 0:S.name)+"ç»†åˆ†",1)]),s("div",ls,[(i(!0),r(P,null,x(((J=g.value)==null?void 0:J.subGroups)||[],a=>(i(),r("button",{key:a.code,onClick:h=>me(a.code),class:y(["group-btn",{"all-btn":a.code.endsWith("_all")}])},[s("span",us,c(a.icon),1),s("span",is,c(a.name),1)],10,cs))),128))])])):u.value==="level"?(i(),r("div",rs,[s("div",{class:"selection-header"},[s("button",{onClick:D,class:"back-btn"},"â† è¿”å›"),e[20]||(e[20]=s("h2",{class:"section-title"},"ğŸ° é€‰æ‹©å…³å¡",-1))]),s("div",ds,[e[21]||(e[21]=s("span",{class:"banner-icon"},"ğŸ“š",-1)),s("span",vs,c(ie(d.value)),1),s("span",ps,c(ce.value),1)]),s("div",fs,[s("button",{class:"page-nav-btn prev",onClick:se,disabled:l.value<=1}," â€¹ ",8,ms),s("div",gs,[s("div",_s,[(i(!0),r(P,null,x(ee.value,a=>(i(),r("button",{key:a,onClick:h=>be(a),class:y(["level-btn",re(a)])},[s("span",hs,c(a),1),s("span",ys,c(de(a)),1),s("span",ks,c(ve(a)),1)],10,bs))),128))])]),s("button",{class:"page-nav-btn next",onClick:te,disabled:l.value>=m.value}," â€º ",8,Cs)]),s("div",Ss,[s("span",ws,c(ae.value),1),s("div",$s,[W.value?(i(),r("button",{key:0,onClick:e[4]||(e[4]=a=>l.value=1),class:y(["range-btn",{active:l.value===1}])},"1-100",2)):k("",!0),ne.value?(i(),r("span",Gs,"...")):k("",!0),(i(!0),r(P,null,x(le.value,a=>(i(),r("button",{key:a,onClick:h=>l.value=a,class:y(["range-btn",{active:l.value===a}])},c(A(a)),11,Ls))),128)),oe.value?(i(),r("span",Ns,"...")):k("",!0),z.value?(i(),r("button",{key:3,onClick:e[5]||(e[5]=a=>l.value=m.value),class:y(["range-btn",{active:l.value===m.value}])},c(A(m.value)),3)):k("",!0)])])])):k("",!0)]),e[22]||(e[22]=s("div",{class:"footer-decoration"},[s("span",{class:"footer-icon"},"ğŸ¨"),s("span",{class:"footer-icon"},"ğŸ“–"),s("span",{class:"footer-icon"},"âœï¸")],-1))])}}},Ms=Ce(Ps,[["__scopeId","data-v-5e5bf2d2"]]);export{Ms as default};
